import{r as j,u as A,j as e,c as F,a as w,O as v,F as g,f as k,b as s,B as f,_ as N,d as B,W as L,e as P,g as G,k as D,h as R,i as U,l as O,R as $,C as H,m as E,n as M,E as W,A as _,o as K}from"./index-SoB214eT.js";import{u as Q,S as V}from"./Spinner-QRriiZDh.js";import{p as z,g as J}from"./usuario.service-81jsQmmJ.js";import"flatpickr/dist/themes/material_green.css";const I=j.forwardRef(({bsPrefix:o,size:c,vertical:a=!1,className:i,role:n="group",as:x="div",...u},t)=>{const r=A(o,"btn-group");let d=r;return a&&(d=`${r}-vertical`),e.jsx(x,{...u,ref:t,role:n,className:F(i,d,c&&`${r}-${c}`)})});I.displayName="ButtonGroup";const X=I,Y=({state:o,handleToggle:c,selection:a,setSelection:i})=>{const{register:n,handleSubmit:x,reset:u,setValue:t,formState:{errors:r}}=w(),d=()=>{c(!1),u(),i(null)},p=Q({mutationFn:z}),l=h=>{const m=new FormData;m.append("op","usuario"),m.append("email",h.email),m.append("lastName",h.lastName),m.append("name",h.name),m.append("password",h.password),m.append("phone",h.phone),m.append("state",h.state),p.mutate(m,{onSuccess:T=>{const{data:q,status:b}=T;if(b>=200&&b<300){const{responseCode:C,message:y}=q;C===1?N.success(y):C===2&&N.error(y)}},onError:()=>{N.error("Error en el servidor.")}})};return j.useEffect(()=>{Object.values(a??{}).length>0&&(t("id",(a==null?void 0:a.id)??""),t("idpersonal",(a==null?void 0:a.idpersonal)??""),t("name",(a==null?void 0:a.name)??""),t("lastName",(a==null?void 0:a.lastName)??""),t("email",(a==null?void 0:a.email)??""),t("phone",(a==null?void 0:a.phone)??""),t("state",(a==null?void 0:a.state)??""))},[a,t]),e.jsx(e.Fragment,{children:e.jsxs(v,{show:o,onHide:d,placement:"end",children:[e.jsxs(v.Header,{children:[e.jsxs(v.Title,{children:[" ",e.jsx("h2",{children:"Agregar usuario"})," "]}),e.jsx("div",{className:"btn-close",onClick:d,children:e.jsx(g,{icon:k})})]}),e.jsx(v.Body,{children:e.jsxs(s,{onSubmit:x(l),className:"position-relative h-100",children:[e.jsxs(s.Group,{className:"mb-1",controlId:"name",children:[e.jsx(s.Label,{children:"Nombre"}),e.jsx(s.Control,{isInvalid:!!r.name,type:"text",placeholder:"Nombre del usuario...",...n("name",{required:!0,maxLength:100})}),r.name&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs(s.Group,{className:"mb-1",controlId:"name",children:[e.jsx(s.Label,{children:"Apellido"}),e.jsx(s.Control,{isInvalid:!!r.lastName,type:"text",placeholder:"Apellido del usuario...",...n("lastName",{required:!0,maxLength:100})}),r.lastName&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs(s.Group,{className:"mb-1",controlId:"email",children:[e.jsx(s.Label,{children:"Correo"}),e.jsx(s.Control,{isInvalid:!!r.email,type:"email",placeholder:"Correo del usuario...",...n("email",{required:!0}),"aria-invalid":r.email?"true":"false"}),r.email&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs(s.Group,{className:"mb-1",controlId:"email",children:[e.jsx(s.Label,{children:"Teléfono"}),e.jsx(s.Control,{isInvalid:!!r.phone,type:"text",placeholder:"teléfono del usuario...",...n("phone",{required:!0}),"aria-invalid":r.email?"true":"false"}),r.email&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs(s.Group,{className:"mb-1",controlId:"email",children:[e.jsx(s.Label,{children:"Clave"}),e.jsx(s.Control,{isInvalid:!!r.password,type:"text",placeholder:"clave del usuario...",...n("password",{required:!0}),"aria-invalid":r.email?"true":"false"}),r.email&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs(s.Group,{className:"mb-1",controlId:"state",children:[e.jsx(s.Label,{children:"Estado"}),e.jsxs(s.Select,{isInvalid:!!r.state,"aria-label":"Default select example",...n("state",{required:!0}),"aria-invalid":r.state?"true":"false",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),e.jsx("option",{value:"activo",children:"Activo"}),e.jsx("option",{value:"inactivo",children:"Inactivo"})]}),r.state&&e.jsx(s.Text,{className:"text-danger",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-10",style:{position:"absolute",bottom:"30px",width:"100%"},children:[e.jsx(f,{variant:"secondary",className:"border-0 me-1",onClick:d,children:e.jsx("span",{className:"text-dark",children:"Cancelar"})}),e.jsxs(f,{variant:"primary",type:"submit",children:[p.isPending&&e.jsx(V,{color:"light",size:"sm"}),e.jsx("span",{className:"align-middle ms-25",children:"Agregar usuario"})]})]})]})})]})})},Z=({params:o,setSelection:c,handleToggle:a})=>{const[i,n]=j.useState(1),[x,u]=j.useState(10),{data:t,isError:r,isLoading:d}=B({queryKey:["usuarios",i,o],queryFn:()=>J({page:i,...o}),placeholderData:D}),p=[{name:"USUARIO",selector:l=>l.name},{name:"CORREO",selector:l=>l.email},{name:"ESTADO",selector:l=>l.state,cell:l=>e.jsx("div",{children:l.state==="activo"?e.jsx("span",{className:"active-badge",children:"Activo"}):e.jsx("span",{className:"inactive-badge",children:"Inactivo"})})},{name:"ACCIÓN",cell:l=>e.jsxs(X,{"aria-label":"Basic example",children:[e.jsx(f,{variant:"light",onClick:()=>{console.log(l),c(l),a(!0)},children:e.jsx(g,{icon:P})}),e.jsx(f,{variant:"light",children:e.jsx(g,{icon:G})})]})}];return e.jsx(L,{title:"",columns:p,isLoading:d,isError:r,data:(t==null?void 0:t.data)??[],recordsTotals:(t==null?void 0:t.recordsTotals)??0,countPerPage:x,setCountPerPage:u,page:i,setPage:n,handleClick:()=>{},handleDoubleClick:()=>{},isExpandable:!1})},S={state:"",search:""},te=()=>{const[o,c]=j.useState(S),[a,i]=j.useState(null),n=R(o,2e3),{state:x,toggle:u}=U(!1),t=p=>{c(l=>({...l,[p.target.name]:p.target.value}))},r=()=>{c(S)},d=O(n);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"my-2",children:"Usuarios"}),e.jsx($,{children:e.jsx(H,{children:e.jsxs(E,{children:[e.jsxs(E.Header,{className:"d-flex",children:[e.jsx("h3",{children:"Filtro"}),d>0?e.jsxs(f,{variant:"link",onClick:r,children:["Limpiar filtros ",e.jsx(g,{icon:K})]}):null]}),e.jsx("div",{className:"card-header-inputs ",children:e.jsxs("div",{className:"w-100 row mt-2 mb-2 ps-1 pe-1",children:[e.jsx("div",{className:"col-12 col-lg-4 ",children:e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",name:"search",className:"form-control",placeholder:"Buscar usuario...",value:o.search||"",onChange:t}),e.jsx("button",{className:"btn btn-outline-secondary",type:"button",disabled:!0,children:e.jsx(g,{icon:M})})]})}),e.jsx("div",{className:"col-12 col-lg-3 mt-2 mt-lg-0",children:e.jsxs("select",{name:"state",className:"form-select",onChange:t,value:o.state||"",children:[e.jsx("option",{value:"",disabled:!0,selected:!0,hidden:!0,children:"Estado"}),e.jsx("option",{value:"activo",children:"Activo"}),e.jsx("option",{value:"inactivo",children:"Inactivo"})]})}),e.jsxs("div",{className:"col-12 col-lg-5 d-flex gap-2 justify-content-between mt-2 mt-lg-0",children:[e.jsx(W,{}),e.jsx(_,{title:"Agregar usuario",handleClick:u})]})]})}),e.jsx(Z,{params:n,setSelection:i,handleToggle:u})]})})}),e.jsx(Y,{state:x,handleToggle:u,selection:a,setSelection:i})]})};export{te as default};
